# Ассистент на базе искусственного интеллекта. Версия 1.0 (Техническая документация)

## Что и где располагается:

### 1. Логи nginx в докере
В папке проекта, откуда идет основная установка есть папка logs. В этой папке logs/nginx хранятся все логи nginx

### 2. Логи сервисов в докере
В папке проекта, откуда идет основная установка есть папка logs. В этой папке logs/services хранятся все логи внутренних сервисов (откровенно пока не все туда пишется, но можно посмотреть, может что-то полезное можно найти)

## Описание встроенных сервисов
В этом разделе описаны сервисы, которые работают в докере

### 1. Nginx
Непосредственно Nginx выступает прокси, он смотрит за пределы докера по порту 1082, внутри докера 80 порт.
Далее в зависимости от запросов (ниже указаны основные запросы):
* `/user/sign-in` - авторизация пользователя
* `/user/sign-up` - регистрация пользователя
* `/user/password` - изменение пароля пользователя
* `/user/reset-password` - сброс пароля (на почту приходит новый сгенерированный пароль)
* `/user/update` - изменение пользователя
* `/user/get` - получение данных о пользователе

Nginx распределяет по правилу:
```c
location / {
        location /user{
        rewrite /(.*) /$1  break;
        proxy_set_header   X-Forwarded-For $remote_addr;
        proxy_set_header   Host $http_host;
        proxy_pass         http://user-http:2800/;
    }
...
}
```
на внутренний сервис user-http по внутреннему порту в докере 2800

* `assistant/new` - создание ассистента
* `assistant/update` - обновление ассистента
* `assistant/get` - получение ассистента
* `assistant/list` - получение ассистентов
* `assistant/delete` - удаление ассистента

Nginx распределяет по правилу:
```c
location / {
        location /assistant {
            rewrite /(.*) /$1  break;
            proxy_set_header   X-Forwarded-For $remote_addr;
            proxy_set_header   Host $http_host;
            proxy_pass         http://assistant-http:2801/;
        }
...
}
```

### 2. User-HTTP
Это сервис, который является http сервером внутри докера и слушает 2800 порт.
Также этот сервис является клиентом к grpc сервису user-grpc
Логи по нему можно посмотреть командой docker logs user-http-assist

### 3. User-GRPC
Это сервис, который является GRPC сервером внутри докера и слушает 2900 порт.
Сервис выполняет всю логику работы с пользователем и работает с базой данных
Логи по нему можно посмотреть командой docker logs user-grpc-assist

### 4. Assistant-HTTP
Это сервис, который является http сервером внутри докера и слушает 2801 порт.
Также этот сервис является клиентом к grpc сервису assistant-grpc
Логи по нему можно посмотреть командой docker logs assistant-http-assist

### 5. Assistant-GRPC
Это сервис, который является GRPC сервером внутри докера и слушает 2900 порт.
Сервис выполняет всю логику работы с ассистентами, диалогами, историей общения и работает с базой данных
Логи по нему можно посмотреть командой docker logs assistant-grpc-assist